import{a as u}from"./chunks/theme.DIt8sTcD.js";import{_ as A,f as v,H as c,k as b,N as g,V as h,F as y,a2 as C,am as D,a1 as B,G as E,K as k,L as m,O as f,W as _,X as I}from"./chunks/framework.2MLJsAWF.js";const F=["jpg","jpeg","png","gif"],o=".jpg、.jpeg、.png、.gif";function j(){return new Promise((i,a)=>{x({multiple:!0,accept:"image/*",typeArr:F}).then(s=>{w(s,F)?i(s):(u.info(`上传文件类型需满足${o}`),a(`上传文件类型需满足${o}`))}).catch(s=>{a(s)})})}function x(i={}){return new Promise((a,s)=>{const d={accept:"*",typeArr:[],multiple:!1,size:10240,limit:5,...i},t=document.createElement("input");t.type="file",t.multiple=d.multiple,t.accept=d.accept,t.style.width="0",t.style.height="0",document.body.appendChild(t),t.click(),t.oninput=p=>{const n=[...p.target.files];L(n,d).then(()=>{a(n)}).catch(l=>{u.error(l),s(l)})},window.addEventListener("focus",()=>{setTimeout(()=>{t.value||(document.body.removeChild(t),s("用户取消上传"))},500)},{once:!0})})}function w(i,a=[]){const s=Array.from(i);let d=[];s.forEach(n=>{d.push(P(n))});const t=d.filter(n=>a.includes(n));return d.length===t.length}function P(i){var a;return(a=i.name.split(".")[i.name.split(".").length-1])==null?void 0:a.toLowerCase()}function L(i,a){return new Promise((s,d)=>{if(i.length>a.limit)return d(`上传数量超过${a.limit}个`);s("校验通过")})}const r=i=>(_("data-v-b0c9a13d"),i=i(),I(),i),T=r(()=>h("h1",{id:"函数式封装上传图片组件",tabindex:"-1"},[k("函数式封装上传图片组件 "),h("a",{class:"header-anchor",href:"#函数式封装上传图片组件","aria-label":'Permalink to "函数式封装上传图片组件"'},"​")],-1)),V=r(()=>h("blockquote",null,[h("p",null,[k("Vue3 + ts函数式封装支持 "),h("code",null,"函数式｜组件"),k(" 两种使用方式")])],-1)),$=r(()=>h("h2",{id:"演示",tabindex:"-1"},[k("演示 "),h("a",{class:"header-anchor",href:"#演示","aria-label":'Permalink to "演示"'},"​")],-1)),S={class:"for-box"},M=["src"],N=D(`<h2 id="解释" tabindex="-1" data-v-b0c9a13d>解释 <a class="header-anchor" href="#解释" aria-label="Permalink to &quot;解释&quot;" data-v-b0c9a13d>​</a></h2><div class="info custom-block" data-v-b0c9a13d><p class="custom-block-title" data-v-b0c9a13d>一、全局挂载</p><div class="language-js vp-adaptive-theme" data-v-b0c9a13d><button title="Copy Code" class="copy" data-v-b0c9a13d></button><span class="lang" data-v-b0c9a13d>js</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-b0c9a13d><code data-v-b0c9a13d><span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// vue2全局挂载</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>Vue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>prototype</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>.$upload </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> uploadImage</span></span>
<span class="line" data-v-b0c9a13d></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// vue3全局挂载</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>app.config.globalProperties.$upload </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> uploadImage</span></span></code></pre></div></div><div class="info custom-block" data-v-b0c9a13d><p class="custom-block-title" data-v-b0c9a13d>二、使用</p><div class="language-js vp-adaptive-theme" data-v-b0c9a13d><button title="Copy Code" class="copy" data-v-b0c9a13d></button><span class="lang" data-v-b0c9a13d>js</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-b0c9a13d><code data-v-b0c9a13d><span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// vue2</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>$upload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {})</span></span>
<span class="line" data-v-b0c9a13d></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// vue3</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> 必须使用proxy，正式环境ctx是获取不到的所以不能使用const { ctx } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d> getCurrentInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>()</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>proxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d> getCurrentInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>()</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>proxy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>$upload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {})</span></span></code></pre></div></div><details class="details custom-block" data-v-b0c9a13d><summary data-v-b0c9a13d>源代码</summary><div class="language-js vp-adaptive-theme" data-v-b0c9a13d><button title="Copy Code" class="copy" data-v-b0c9a13d></button><span class="lang" data-v-b0c9a13d>js</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-b0c9a13d><code data-v-b0c9a13d><span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> { message } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d> &#39;ant-design-vue&#39;</span></span>
<span class="line" data-v-b0c9a13d></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> IMAGE_TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;jpg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;jpeg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;png&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;gif&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>]</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> typeMes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d> &#39;.jpg、.jpeg、.png、.gif&#39;</span></span>
<span class="line" data-v-b0c9a13d></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 全局引入,二次封装，只限于上传图片</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d> uploadImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>() {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>        uploadWhole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>({</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            multiple: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>,</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            accept: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;image/*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>,</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            typeArr: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>IMAGE_TYPE</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>fileList</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>                if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>judgeImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(fileList, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>IMAGE_TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>)) {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>                    // 临时本地回显，后续调用阿里云对接第三方上传</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>                    resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(fileList)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                    message.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>\`上传文件类型需满足\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>typeMes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>                    reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>\`上传文件类型需满足\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>typeMes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                }</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>                reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(err)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>    })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>}</span></span>
<span class="line" data-v-b0c9a13d></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 核心：上传功能</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d> uploadWhole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {}) {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            accept: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 接受的文件类型</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            typeArr: [], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 接受的文件类型，格式列表</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            multiple: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 是否多选</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            size: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>10240</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 文件大小限制，单位是kb</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            limit: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 可选文件个数限制</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>            ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>options</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        }</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> input</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;input&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        input.type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d> &#39;file&#39;</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        input.multiple </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> config.multiple</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        input.accept </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> config.accept</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        input.style.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d> &#39;0&#39;</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        input.style.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d> &#39;0&#39;</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(input)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        input.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>()</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        input.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>oninput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d> e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>            // 必须做一次拷贝</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>e.target.files]</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>            check</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(list, config)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>                    resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(list)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                    message.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(err)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>                    reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(err)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        }</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>            &#39;focus&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>,</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>                setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>                    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>input.value) {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                        document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(input)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>                        reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;用户取消上传&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                    }</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>                }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            },</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>            { once: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> }</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        )</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>    })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>}</span></span>
<span class="line" data-v-b0c9a13d></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 判断是不是图片</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d> judgeImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>typeList</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> []) {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>    // file：要判断的文件，typeList：非必需，上传文件类型数组</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> Array.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(file)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> arr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> []</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>    list.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>ele</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        arr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>filterImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(ele))</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>    })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> fileList</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> arr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>ele</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> typeList.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(ele)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>    })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> ifT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> arr.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> fileList.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> ?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> true</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> false</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> ifT</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>}</span></span>
<span class="line" data-v-b0c9a13d></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 获取文件类型</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d> filterImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>item</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>) {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> item.name.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>split</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>)[item.name.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>split</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>).</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>]?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>toLowerCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>()</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>}</span></span>
<span class="line" data-v-b0c9a13d></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>// 校验</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d> check</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>) {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-b0c9a13d>reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>        // 长度校验</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> (list.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-b0c9a13d>length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d> config.limit) {</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-b0c9a13d>            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d> reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>\`上传数量超过\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>limit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>}个\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>        }</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>        // accept校验...</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-b0c9a13d>        // size校验...</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-b0c9a13d>        resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-b0c9a13d>&#39;校验通过&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>)</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>    })</span></span>
<span class="line" data-v-b0c9a13d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-b0c9a13d>}</span></span></code></pre></div></details>`,4),q=JSON.parse('{"title":"函数式封装上传图片组件","description":"在vue中使用函数式封装上传图片组件","frontmatter":{"title":"函数式封装上传图片组件","description":"在vue中使用函数式封装上传图片组件"},"headers":[],"relativePath":"web/vue/uploadImage/index.md","filePath":"web/vue/uploadImage/index.md"}'),G={name:"web/vue/uploadImage/index.md"},O=Object.assign(G,{setup(i){const a=v([]),s=v(!1);function d(){s.value=!0,j().then(p=>{const n=[];p.forEach(l=>{const e=URL.createObjectURL(l);n.push(e)}),a.value=[...a.value,...n]}).finally(()=>{s.value=!1})}function t(){a.value.length=0}return(p,n)=>{const l=B("a-button");return E(),c("div",null,[T,V,$,b(l,{type:"primary",onClick:d,loading:s.value,style:{"margin-right":"10px"}},{default:g(()=>[k(m(s.value?"上传中...":"上传"),1)]),_:1},8,["loading"]),b(l,{type:"primary",onClick:t},{default:g(()=>[k("清空图片")]),_:1}),h("div",S,[(E(!0),c(y,null,C(a.value,e=>(E(),c(y,{key:e},[e?(E(),c("img",{key:0,src:e,class:"show-img"},null,8,M)):f("",!0)],64))),128))]),N])}}}),z=A(O,[["__scopeId","data-v-b0c9a13d"]]);export{q as __pageData,z as default};
