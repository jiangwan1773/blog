import{a as C}from"./chunks/theme.r_ZMMF3o.js";import{_ as B,f as y,a1 as F,H as E,k as g,N as c,V as l,F as o,a2 as m,ac as f,G as r,K as p,L as _,O as b,W as I,X as j}from"./chunks/framework.d6SjVawx.js";const u=["jpg","jpeg","png","gif"],A=".jpg、.jpeg、.png、.gif";function x(){return new Promise((d,a)=>{w({multiple:!0,accept:"image/*",typeArr:u}).then(s=>{L(s,u)?d(s):(C.info(`上传文件类型需满足${A}`),a(`上传文件类型需满足${A}`))}).catch(s=>{a(s)})})}function w(d={}){return new Promise((a,s)=>{const t={accept:"*",typeArr:[],multiple:!1,size:10240,limit:5,...d},i=document.createElement("input");i.type="file",i.multiple=t.multiple,i.accept=t.accept,i.style.width="0",i.style.height="0",document.body.appendChild(i),i.click(),i.oninput=k=>{const n=[...k.target.files];T(n,t).then(()=>{a(n)}).catch(h=>{C.error(h),s(h)})},window.addEventListener("focus",()=>{setTimeout(()=>{i.value||(document.body.removeChild(i),s("用户取消上传"))},500)},{once:!0})})}function L(d,a=[]){const s=Array.from(d);let t=[];s.forEach(n=>{t.push(P(n))});const i=t.filter(n=>a.includes(n));return t.length===i.length}function P(d){var a;return(a=d.name.split(".")[d.name.split(".").length-1])==null?void 0:a.toLowerCase()}function T(d,a){return new Promise((s,t)=>{if(d.length>a.limit)return t(`上传数量超过${a.limit}个`);s("校验通过")})}const D=d=>(I("data-v-0dd9d134"),d=d(),j(),d),V=D(()=>l("blockquote",null,[l("p",null,[p("Vue3 + ts函数式封装支持 "),l("code",null,"函数式｜组件"),p(" 两种使用方式")])],-1)),$=D(()=>l("h2",{id:"演示",tabindex:"-1"},[p("演示 "),l("a",{class:"header-anchor",href:"#演示","aria-label":'Permalink to "演示"'},"​")],-1)),S={class:"for-box"},M=["src"],N=f(`<h2 id="解释" tabindex="-1" data-v-0dd9d134>解释 <a class="header-anchor" href="#解释" aria-label="Permalink to &quot;解释&quot;" data-v-0dd9d134>​</a></h2><div class="info custom-block" data-v-0dd9d134><p class="custom-block-title" data-v-0dd9d134>一、全局挂载</p><div class="language-js vp-adaptive-theme" data-v-0dd9d134><button title="Copy Code" class="copy" data-v-0dd9d134></button><span class="lang" data-v-0dd9d134>js</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-0dd9d134><code data-v-0dd9d134><span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// vue2全局挂载</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>Vue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>prototype</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>.$upload </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> uploadImage</span></span>
<span class="line" data-v-0dd9d134></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// vue3全局挂载</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>app.config.globalProperties.$upload </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> uploadImage</span></span></code></pre></div></div><div class="info custom-block" data-v-0dd9d134><p class="custom-block-title" data-v-0dd9d134>二、使用</p><div class="language-js vp-adaptive-theme" data-v-0dd9d134><button title="Copy Code" class="copy" data-v-0dd9d134></button><span class="lang" data-v-0dd9d134>js</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-0dd9d134><code data-v-0dd9d134><span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// vue2</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>$upload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {})</span></span>
<span class="line" data-v-0dd9d134></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// vue3</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> 必须使用proxy，正式环境ctx是获取不到的所以不能使用const { ctx } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134> getCurrentInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>()</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>proxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134> getCurrentInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>()</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>proxy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>$upload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {})</span></span></code></pre></div></div><details class="details custom-block" data-v-0dd9d134><summary data-v-0dd9d134>源代码</summary><div class="language-js vp-adaptive-theme" data-v-0dd9d134><button title="Copy Code" class="copy" data-v-0dd9d134></button><span class="lang" data-v-0dd9d134>js</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-0dd9d134><code data-v-0dd9d134><span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> { message } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134> &#39;ant-design-vue&#39;</span></span>
<span class="line" data-v-0dd9d134></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> IMAGE_TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;jpg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;jpeg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;png&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;gif&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>]</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> typeMes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134> &#39;.jpg、.jpeg、.png、.gif&#39;</span></span>
<span class="line" data-v-0dd9d134></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 全局引入,二次封装，只限于上传图片</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134> uploadImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>() {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>        uploadWhole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>({</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            multiple: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>,</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            accept: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;image/*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>,</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            typeArr: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>IMAGE_TYPE</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>fileList</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>                if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>judgeImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(fileList, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>IMAGE_TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>)) {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>                    // 临时本地回显，后续调用阿里云对接第三方上传</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>                    resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(fileList)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                    message.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>\`上传文件类型需满足\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>typeMes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>                    reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>\`上传文件类型需满足\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>typeMes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                }</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>                reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(err)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>    })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>}</span></span>
<span class="line" data-v-0dd9d134></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 核心：上传功能</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134> uploadWhole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {}) {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            accept: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 接受的文件类型</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            typeArr: [], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 接受的文件类型，格式列表</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            multiple: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 是否多选</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            size: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>10240</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 文件大小限制，单位是kb</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            limit: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 可选文件个数限制</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>            ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>options</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        }</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> input</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;input&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        input.type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134> &#39;file&#39;</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        input.multiple </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> config.multiple</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        input.accept </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> config.accept</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        input.style.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134> &#39;0&#39;</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        input.style.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134> &#39;0&#39;</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(input)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        input.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>()</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        input.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>oninput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134> e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>            // 必须做一次拷贝</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>e.target.files]</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>            check</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(list, config)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>                    resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(list)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                    message.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(err)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>                    reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(err)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        }</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>            &#39;focus&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>,</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>                setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>                    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>input.value) {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                        document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(input)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>                        reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;用户取消上传&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                    }</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>                }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            },</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>            { once: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> }</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        )</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>    })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>}</span></span>
<span class="line" data-v-0dd9d134></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 判断是不是图片</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134> judgeImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>typeList</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> []) {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>    // file：要判断的文件，typeList：非必需，上传文件类型数组</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> Array.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(file)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> arr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> []</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>    list.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>ele</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        arr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>filterImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(ele))</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>    })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> fileList</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> arr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>ele</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> typeList.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(ele)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>    })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> ifT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> arr.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> fileList.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> ?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> true</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> false</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> ifT</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>}</span></span>
<span class="line" data-v-0dd9d134></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 获取文件类型</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134> filterImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>item</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>) {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> item.name.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>split</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>)[item.name.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>split</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>).</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>]?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>toLowerCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>()</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>}</span></span>
<span class="line" data-v-0dd9d134></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>// 校验</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134> check</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>) {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-0dd9d134>reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>        // 长度校验</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> (list.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-0dd9d134>length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134> config.limit) {</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-0dd9d134>            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134> reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>\`上传数量超过\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>limit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>}个\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>        }</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>        // accept校验...</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-0dd9d134>        // size校验...</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-0dd9d134>        resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-0dd9d134>&#39;校验通过&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>)</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>    })</span></span>
<span class="line" data-v-0dd9d134><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-0dd9d134>}</span></span></code></pre></div></details>`,4),q=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"web/vue/uploadImage/index.md","filePath":"web/vue/uploadImage/index.md"}'),G={name:"web/vue/uploadImage/index.md"},O=Object.assign(G,{setup(d){const a=y([]),s=y(!1);function t(){s.value=!0,x().then(k=>{const n=[];k.forEach(h=>{const e=URL.createObjectURL(h);n.push(e)}),a.value=[...a.value,...n]}).finally(()=>{s.value=!1})}function i(){a.value.length=0}return(k,n)=>{const h=F("c-title"),e=F("a-button");return r(),E("div",null,[g(h,{title:"函数式封装上传图片组件"}),V,$,g(e,{type:"primary",onClick:t,loading:s.value,style:{"margin-right":"10px"}},{default:c(()=>[p(_(s.value?"上传中...":"上传"),1)]),_:1},8,["loading"]),g(e,{type:"primary",onClick:i},{default:c(()=>[p("清空图片")]),_:1}),l("div",S,[(r(!0),E(o,null,m(a.value,v=>(r(),E(o,{key:v},[v?(r(),E("img",{key:0,src:v,class:"show-img"},null,8,M)):b("",!0)],64))),128))]),N])}}}),z=B(O,[["__scopeId","data-v-0dd9d134"]]);export{q as __pageData,z as default};
